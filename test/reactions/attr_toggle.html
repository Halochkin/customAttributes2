<script src="https://cdn.jsdelivr.net/gh/orstavik/ElementObserver@1.1.2/observeElementCreation.js"></script>
<script src="../../src/customAttributes.js"></script>
<script src="../../src/core.js"></script>

<style>
  #bob:not([open]) > :not(h1) { display: none; }
</style>

<div id="bob">
  <h1 click:log::open:log>hello</h1>
  <p>sunshine</p>
</div>

<script>
  customReactions.defineAll({
    "log": e => (console.log(getComputedStyle(document.querySelector("p")).display), e),
    "open": function (e, prefix, suffix) {
      suffix = suffix?.toUpperCase();
      let el = this.ownerElement.parentElement;
      while (el && suffix && el.tagName !== suffix)
        el = el.parentElement;
      if (!el)
        return;
      el.hasAttribute(prefix) ? el.removeAttribute(prefix) : el.setAttribute(prefix);
      return e;
    }
  });
  document.querySelector("h1").click();
</script>