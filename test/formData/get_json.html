<script src="https://cdn.jsdelivr.net/gh/orstavik/parse@v1.0.2/parse.js"></script>
<script src="https://cdn.jsdelivr.net/gh/orstavik/ElementObserver/constructionFrame.js"></script>
<script src="../../src/EventRegistry.js"></script>
<script src="../../src/EventFilterRegistry.js"></script>
<script src="../../src/virtualEventLoop.js"></script>

<h1 submit:get_json="https://httpbin.org/anything?hello=sunshine" get:log="1"></h1>

<script type="module">
  import {JSON_GET} from "../src/FormData/FormData_GET.js";

  customEventFilters.define("get", JSON_GET);

  const log = {};

  function doLog(e) {
    let k = this.value;
    let url = e.detail.url;
    let method = e.detail.method;
    let args = e.detail.args;
    let data = e.detail.data;
    let form = e.detail.form;
    log[k] = [url, method, args, data, form];
    const entries = Object.entries(log);
    if (entries.length === 1)
      console.log(...entries.sort());
  }

  customEventFilters.define("log", doLog);

  document.querySelector("h1").dispatchEvent(new CustomEvent("submit", {detail: [["hello", "sunshine"]]}));
</script>